window.slate=window.slate||{},slate.utils={findInstance:function(t,n,e){for(var i=0;i<t.length;i++)if(t[i][n]===e)return t[i]},removeInstance:function(t,n,e){for(var i=t.length;i--;)if(t[i][n]===e){t.splice(i,1);break}return t},compact:function(t){for(var n=-1,e=null==t?0:t.length,i=0,o=[];++n<e;){var s=t[n];s&&(o[i++]=s)}return o},defaultTo:function(t,n){return null==t||t!=t?n:t}},slate.Sections=function(){this.constructors={},this.instances=[],$(document).on("shopify:section:load",this._onSectionLoad.bind(this)).on("shopify:section:unload",this._onSectionUnload.bind(this)).on("shopify:section:select",this._onSelect.bind(this)).on("shopify:section:deselect",this._onDeselect.bind(this)).on("shopify:section:reorder",this._onReorder.bind(this)).on("shopify:block:select",this._onBlockSelect.bind(this)).on("shopify:block:deselect",this._onBlockDeselect.bind(this))},slate.Sections.prototype=$.extend({},slate.Sections.prototype,{_createInstance:function(t,n){var e=$(t),i=e.attr("data-section-id"),o=e.attr("data-section-type");if(void 0!==(n=n||this.constructors[o])){var s=$.extend(new n(t),{id:i,type:o,container:t});this.instances.push(s)}},_onSectionLoad:function(t){var n=$("[data-section-id]",t.target)[0];n&&this._createInstance(n)},_onSectionUnload:function(t){var n=slate.utils.findInstance(this.instances,"id",t.detail.sectionId);n&&("function"==typeof n.onUnload&&n.onUnload(t),this.instances=slate.utils.removeInstance(this.instances,"id",t.detail.sectionId))},_onSelect:function(t){var n=slate.utils.findInstance(this.instances,"id",t.detail.sectionId);n&&"function"==typeof n.onSelect&&n.onSelect(t)},_onDeselect:function(t){var n=slate.utils.findInstance(this.instances,"id",t.detail.sectionId);n&&"function"==typeof n.onDeselect&&n.onDeselect(t)},_onReorder:function(t){var n=slate.utils.findInstance(this.instances,"id",t.detail.sectionId);n&&"function"==typeof n.onReorder&&n.onReorder(t)},_onBlockSelect:function(t){var n=slate.utils.findInstance(this.instances,"id",t.detail.sectionId);n&&"function"==typeof n.onBlockSelect&&n.onBlockSelect(t)},_onBlockDeselect:function(t){var n=slate.utils.findInstance(this.instances,"id",t.detail.sectionId);n&&"function"==typeof n.onBlockDeselect&&n.onBlockDeselect(t)},register:function(t,n){this.constructors[t]=n,$("[data-section-type="+t+"]").each(function(t,e){this._createInstance(e,n)}.bind(this))}});